<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Chatbot Quiz with Audio</title>
<style>
    body {
        font-family: Arial, sans-serif;
        background-color: #f5f5f5;
        margin: 0;
        padding: 0;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
    }
    #chatbox {
        width: 400px;
        max-width: 90%;
        background-color: #fff;
        border-radius: 10px;
        box-shadow: 0 0 10px rgba(0,0,0,0.2);
        overflow: hidden;
        display: flex;
        flex-direction: column;
    }
    #messages {
        flex: 1;
        padding: 10px;
        overflow-y: auto;
    }
    .message {
        margin: 10px 0;
        padding: 10px;
        border-radius: 10px;
        max-width: 80%;
        clear: both;
    }
    .bot {
        background-color: #e1f5fe;
        float: left;
    }
    .user {
        background-color: #c8e6c9;
        float: right;
    }
    .option {
        display: block;
        padding: 8px;
        margin: 5px 0;
        background-color: #f0f0f0;
        border-radius: 5px;
        cursor: pointer;
    }
    .correct {
        background-color: #a5d6a7 !important;
    }
    .incorrect {
        background-color: #ef9a9a !important;
    }
    #score {
        padding: 10px;
        background-color: #eee;
        text-align: center;
        font-weight: bold;
    }
</style>
</head>
<body>

<div id="chatbox">
    <div id="messages"></div>
    <div id="score">Score: 0</div>
</div>

<script>
const questions = [
    {q:"What part of speech is the word 'quickly' in 'She ran quickly to catch the bus'?", options:{a:"Adverb", b:"Adjective", c:"Verb", d:"Noun"}, answer:"a"},
    {q:"Identify the verb in the sentence: 'He plays football every Sunday.'", options:{a:"He", b:"football", c:"plays", d:"Sunday"}, answer:"c"},
    {q:"Choose the adjective: 'The beautiful garden was full of flowers.'", options:{a:"garden", b:"was", c:"beautiful", d:"flowers"}, answer:"c"},
    {q:"Which word is a noun? 'The cat slept on the mat.'", options:{a:"slept", b:"on", c:"cat", d:"mat"}, answer:"c"},
    {q:"Identify the pronoun in: 'She gave him a gift.'", options:{a:"gift", b:"gave", c:"She", d:"a"}, answer:"c"},
    {q:"Which is a preposition in 'The book is on the table'?", options:{a:"book", b:"on", c:"is", d:"table"}, answer:"b"},
    {q:"Select the conjunction: 'I wanted to go, but it rained.'", options:{a:"I", b:"to", c:"but", d:"it"}, answer:"c"},
    {q:"Find the interjection: 'Wow! That was amazing.'", options:{a:"That", b:"amazing", c:"Wow", d:"was"}, answer:"c"},
    {q:"Identify the article: 'An apple a day keeps the doctor away.'", options:{a:"apple", b:"An", c:"doctor", d:"away"}, answer:"b"},
    {q:"What is the adverb in: 'He spoke softly to the child.'", options:{a:"spoke", b:"softly", c:"child", d:"to"}, answer:"b"},
    {q:"Choose the adjective in: 'The sky is very blue today.'", options:{a:"sky", b:"very", c:"blue", d:"today"}, answer:"c"},
    {q:"Which word is a noun? 'Happiness is the key to success.'", options:{a:"Happiness", b:"is", c:"to", d:"key"}, answer:"a"},
    {q:"Find the pronoun: 'They went to the park together.'", options:{a:"went", b:"They", c:"park", d:"together"}, answer:"b"},
    {q:"Select the preposition: 'The cat jumped over the wall.'", options:{a:"cat", b:"jumped", c:"over", d:"wall"}, answer:"c"},
    {q:"Which is a conjunction: 'I like tea and coffee.'", options:{a:"like", b:"and", c:"coffee", d:"tea"}, answer:"b"},
    {q:"Identify the interjection: 'Oh no! I forgot my keys.'", options:{a:"keys", b:"Oh no", c:"forgot", d:"my"}, answer:"b"},
    {q:"What is the article: 'The dog barked loudly.'", options:{a:"dog", b:"barked", c:"The", d:"loudly"}, answer:"c"},
    {q:"Find the adverb: 'She quickly finished her homework.'", options:{a:"quickly", b:"finished", c:"her", d:"homework"}, answer:"a"},
    {q:"Choose the adjective: 'It was a bright sunny day.'", options:{a:"It", b:"bright", c:"day", d:"was"}, answer:"b"},
    {q:"Which word is a noun? 'Music soothes the soul.'", options:{a:"soothes", b:"Music", c:"the", d:"soul"}, answer:"b"}
];

let currentQuestion = 0;
let score = 0;
const messages = document.getElementById("messages");
const scoreDisplay = document.getElementById("score");

function speak(text) {
    if (!window.speechSynthesis) return;
    const utter = new SpeechSynthesisUtterance(text);
    utter.lang = "en-US";
    window.speechSynthesis.speak(utter);
}

function addMessage(text, sender="bot") {
    const div = document.createElement("div");
    div.className = "message " + sender;
    div.innerHTML = text;
    messages.appendChild(div);
    messages.scrollTop = messages.scrollHeight;
    if(sender === "bot") speak(text.replace(/<[^>]*>/g, "")); // remove HTML tags for speech
}

function showQuestion() {
    if (currentQuestion >= questions.length) {
        addMessage(`Quiz Finished! Your final score is ${score}/${questions.length}.`);
        return;
    }

    const q = questions[currentQuestion];
    let html = `<strong>Q${currentQuestion+1}:</strong> ${q.q}<br>`;
    for (let key in q.options) {
        html += `<span class="option" data-key="${key}">${key.toUpperCase()}: ${q.options[key]}</span>`;
    }
    addMessage(html);
    attachOptionListeners();
}

function attachOptionListeners() {
    document.querySelectorAll(".option").forEach(el => {
        el.addEventListener("click", function() {
            const selected = this.getAttribute("data-key");
            const correct = questions[currentQuestion].answer;

            if (selected === correct) {
                this.classList.add("correct");
                addMessage("Correct!", "bot");
                score++;
            } else {
                this.classList.add("incorrect");
                document.querySelector(`.option[data-key='${correct}']`)?.classList.add("correct");
                addMessage(`Incorrect! Correct answer is ${correct.toUpperCase()}: ${questions[currentQuestion].options[correct]}`, "bot");
            }
            scoreDisplay.textContent = `Score: ${score}`;
            document.querySelectorAll(".option").forEach(opt => opt.style.pointerEvents = "none");

            setTimeout(() => {
                currentQuestion++;
                showQuestion();
            }, 2000);
        });
    });
}

// Start the quiz
addMessage("Hello! Let's start the quiz. I will read each question and you select the answer.");
setTimeout(showQuestion, 1000);
</script>

</body>
</html>
